#
#   $Id$
#   This patch retrieved from:
#   http://cvs.terraplex.com/yellowdog-4.0-release/releases/yellowdog-4.0/en/os/SRPMS/pdisk-0.8-3.ydl.1.src.rpm
#
diff -uNr pdisk.o/pdisk.c pdisk/pdisk.c
--- pdisk.o/pdisk.c	2000-05-16 08:09:00.000000000 -0600
+++ pdisk/pdisk.c	2003-04-30 22:01:49.000000000 -0600
@@ -115,6 +115,7 @@
 // Forward declarations
 //
 void do_change_map_size(partition_map_header *map);
+void do_change_partition_type(partition_map_header *map);
 void do_create_partition(partition_map_header *map, int get_type);
 void do_delete_partition(partition_map_header *map);
 void do_display_block(partition_map_header *map, char *alt_name);
@@ -582,6 +583,10 @@
 	case 'n':
 	    do_rename_partition(map);
 	    break;
+	case 'T':
+	case 't':
+	    do_change_partition_type(map);
+	    break;
 	case 'D':
 	case 'd':
 	    do_delete_partition(map);
@@ -947,6 +954,37 @@
 }
 
 void
+do_change_partition_type(partition_map_header *map)
+{
+    partition_map * entry;
+    char *name;
+    long part;
+
+    if (map == NULL) {
+	bad_input("No partition map exists");
+	return;
+    }
+    if (!rflag && map->writeable == 0) {
+	printf("The map is not writeable.\n");
+    }
+    if (get_number_argument("Partition number: ", &part, kDefault) == 0) {
+        bad_input("Not valid partition");
+	return;
+    }
+    if (get_string_argument("New partition type: ", &name, 1) == 0) {
+	bad_input("Bad name");
+	return;
+    }
+    entry = find_entry_by_disk_address(part, map);
+    if (entry == NULL) {
+	printf("No such partition\n");
+    } else {
+        strncpy(entry->data->dpme_type, name, DPISTRLEN);
+        map->changed = 1;
+    }
+}
+
+void
 do_change_map_size(partition_map_header *map)
 {
     long size;
